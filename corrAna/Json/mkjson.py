import json

# Moudle 4 的温度数据（按行数）
moudle_4_data = [
    ("2024-09-22 15:50:05", 24.70),
    ("2024-09-22 13:18:45", 24.60),
    ("2024-09-22 11:23:21", 24.50),
    ("2024-09-22 07:48:32", 24.40),
    ("2024-09-22 06:01:09", 24.30),
    ("2024-09-22 04:58:07", 24.20),
    ("2024-09-22 04:31:27", 24.10),
    ("2024-09-22 04:11:16", 24.00),
    ("2024-09-22 03:54:22", 23.90),
    ("2024-09-22 03:45:00", 23.80),
    ("2024-09-22 03:35:09", 23.70),
    ("2024-09-22 03:28:25", 23.60),
    ("2024-09-22 03:23:04", 23.50),
    ("2024-09-22 03:18:39", 23.40),
    ("2024-09-22 03:15:32", 23.30),
    ("2024-09-22 03:12:06", 23.20),
    ("2024-09-22 03:09:31", 23.10),
    ("2024-09-22 03:07:37", 23.00),
    ("2024-09-22 03:05:35", 22.90),
    ("2024-09-22 03:03:32", 22.80),
    ("2024-09-22 03:02:04", 22.70),
    ("2024-09-22 03:00:46", 22.60),
    ("2024-09-22 02:59:10", 22.50),
    ("2024-09-22 01:35:48", 22.40),
    ("2024-09-22 01:38:40", 22.30),
    ("2024-09-22 01:39:59", 22.20),
    ("2024-09-22 01:41:13", 22.10),
    ("2024-09-22 01:42:21", 22.00),
    ("2024-09-22 01:43:35", 21.90),
    ("2024-09-22 01:45:54", 21.80),
    ("2024-09-22 01:47:14", 21.70),
    ("2024-09-22 01:50:22", 21.60),
    ("2024-09-22 01:53:43", 21.50),
    ("2024-09-22 01:56:37", 21.40),
    ("2024-09-22 01:59:49", 21.30),
    ("2024-09-22 02:05:01", 21.20),
    ("2024-09-22 02:10:32", 21.10),
    ("2024-09-22 02:17:31", 21.00),
    ("2024-09-22 02:24:39", 20.90),
]

# 温度修正文件的生成函数
def generate_correction_file(moudle_file, moudle_name):
    corrections = {}
    # 打开原始数据文件
    with open(moudle_file, 'r') as f:
        lines = f.readlines()

        # 按行数进行匹配
        for i, (timestamp, m4_temp) in enumerate(moudle_4_data):
            if i < len(lines):
                parts = lines[i].strip().split()
                if len(parts) == 4:
                    moudle_temp = float(parts[2])

                    # 计算温度差
                    temp_diff = moudle_temp - m4_temp
                    corrections[f"{m4_temp:.1f}"] = round(temp_diff, 2)

    # 将结果写入 JSON 文件
    with open(f"{moudle_name}.json", 'w') as json_file:
        json.dump(corrections, json_file, indent=4)

# 对需要修正的 Moudle 文件生成 JSON
moudle_files = {
    "Moudle_0": "Moudle_0_origin.txt",
    "Moudle_1": "Moudle_1_origin.txt",
    "Moudle_2": "Moudle_2_origin.txt",
    "Moudle_3": "Moudle_3_origin.txt",
    "Moudle_5": "Moudle_5_origin.txt",
    "Moudle_6": "Moudle_6_origin.txt",
    "Moudle_7": "Moudle_7_origin.txt",
}

for moudle_name, moudle_file in moudle_files.items():
    generate_correction_file(moudle_file, moudle_name)
